<!---
start: affixing
affixed: blueprint
blueprint: fn-3-blueprint.svg
preview: fn-3.svg
-->

# FN-3

<p align='center' class='md-only'>
  <img src='fn-3.svg'/>
</p>

> Генератор функций

FN-3 - это простой генератор функции от значения. Он поддерживает 3 режима - синусоида, треугольная волна и меандр (прямоугольные импульсы). В качестве входящего сигнала подразумевается пилообразная волна в диапазоне от 0 до 10 вольт, при этих условиях на выходе будет получен сигнал с ожидаемой периодической формой.

FN-3 поддерживает ШИМ (PWM). Особенность FN-3 в том, как работает [регулятор ШИМ](#controls-pwm) в режиме волн отличных от меандра. Далее будут рассмотрены все доступные режимы.

## Синусоида

У режима синусоиды есть отличие от применения простой функции *sin* к сигналу. При входящем значении равном 0 вольт генерируется значение, равное значению *sin(x)* при *x = -1/2 Пи*, то есть, используется точка минимума функции *sin*. Далее, по мере увеличения входящего сигнала до 10V значение *x* увеличивается до *3/2 Пи*. Таким образом для одного периода пилообразной волны будет сгенерирован фрагмент синусоиды с пологим подъёмом в начале и пологим спуском ближе к концу периода.

Это сделано для того, чтобы сделать регулятор PWM в режиме синусоиды более применимым на практике. То, что он делает - уменьшает продолжительность первого полупериода (делает короче подъём синусоиды) и растягивает продолжительность второго полупериода (делает длиннее спуск). Вторая причина такого среза диапазона в удобстве применения его к привычным сигналам - более низкие значения входящего сигнала генерируют низкие значения на выходе и проще избегать нежелательных резких скачков.

## Треугольник

Режим треугольника схож по структуре выдаваемой волны с режимом синусоиды, то есть, подъём занимает первый полупериод входящей пилы, а спуск - второй, только форма подъёма и спуска - прямая линия.

Особенность режима треугольника в том, что регулировка параметра PWM приводит к тому, что в крайних его положениях и при подаче на вход пилы результирующая волна тоже становится пилообразной. То есть, регулируя PWM можно плавно преваращать треугольник в пилу.

## Меандр

Режим меандра не требует особых комментариев, здесь всё просто - центральное положение ручки PWM устанавливает ширину импульса равной половине периода входящей пилы с диапазоном от 0V до 10V. Регулировка ручки влево делает импульсы короче, вправо - длиннее, вплоть до предельных значений, когда в результате может получиться сплошной высокий уровень или сплошной низкий уровень.

## История создания

Этот модуль создавался для возможности получения различных огибающих и LFO. Изначальная идея была в том, что сигнал с фазой из модуля [Clock](./clock) можно подать в модуль [Divider](./divider) растянув фазу до желаемого периода, а потом при помощи FN-3 превратить её в волну желаемой формы и использовать её для управления какими-нибудь другими модулями в идеальной синхронизации с основным темпом. Как пример, с таким подходом можно легко реализовать плавное возрастание громкости или частоты LP фильтра на протяжении, скажем, 16 тактов музыки.

Помимо вышеописанного примера, модуль находит огромное количество других способов применения вплоть до преобразования звуковых сигналов.

<img align='right' src='fn-3-blueprint.svg' class='md-only'/>

## Главная панель

<!---
start: legend
-->

<!---
start: legend-group
slug: inputs
-->

### Входы

* <!---
  x: 10
  y: 93
  slug: pwm
  type: simple-socket
  -->
  <a name="inputs-pwm" href='#inputs-pwm'>PWM</a> - Pulse Width (Modulation), ширина импульса. Рабочий диапазон при центральном положении регулятора от -5V до +5V, но значения за пределами диапазона тоже поддерживаются, если [регулятор PWM](#controls-pwm) находится не в центральном положении.

* <!---
  x: 10
  y: 194
  slug: shift
  type: labeled-socket
  -->
  <a name="inputs-shift" href='#inputs-shift'>Shift</a> - смещение фазы результирующей волны. Диапазон не ограничен, каждые 5 вольт с той или иной полярностью соответствуют смещению фазы на 360 градусов в ту или иную сторону.

* <!---
  x: 10
  y: 275
  slug: phase
  type: labeled-socket
  -->
  <a name="inputs-phase" href='#inputs-phase'>Phase</a> - исходная фаза, главный вход модуля. Предполагается использование сигналов в диапазоне от 0V до 10V, но сигналы за пределами диапазона так же поддерживаются.

<!---
end: legend-group
-->

<!---
start: legend-group
slug: outputs
-->

### Выходы

* <!---
  x: 10
  y: 320
  slug: wave
  type: labeled-socket
  -->
  <a name="inputs-wave" href='#inputs-wave'>Wave</a> - результирующая волна. Диапазон зависит от выбранного [режима полярности](#controls-polarity).

<!---
end: legend-group
-->

<!---
start: legend-group
slug: controls
-->

### Управление

* <!---
  x: 8
  y: 58
  slug: pwm
  type: knob-27
  -->
  <a name="controls-pwm" href='#controls-pwm'>PWM</a> - Pulse Width (Modulation), ширина импульса.

* <!---
  x: 8
  y: 126
  slug: mode
  type: display-switch
  -->
  <a name="controls-mode" href='#controls-mode'>Mode</a> - режим - SIN, TRI или SQR.

* <!---
  x: 8
  y: 152
  slug: polarity
  type: display-switch
  -->
  <a name="controls-polarity" href='#controls-polarity'>Polarity</a> - полярность - UNI (юниполярная) или BI (биполярная). В юниполярном режиме диапазон значений на выходе от 0V до 10V, при биполярном - от -5V до +5V.

* <!---
  x: 10
  y: 229
  slug: shift
  type: knob-25
  -->
  <a name="controls-shift" href='#controls-shift'>Shift</a> - сдвиг фазы. Диапазон регулятора от -360 градусов до +360 градусов.

<!---
end: legend-group
-->

<!---
start: legend-group
slug: indicators
-->

### Индикация

* <!---
  x: 8
  y: 126
  slug: wave
  type: fn-3-display
  -->
  <a name="indicators-wave" href='#indicators-wave'>Waveform</a> - визуализация работы выбранного режима при текущих параметрах на диапазоне входящей фазы от 0V до 10V.

<!---
end: legend-group
-->

<!---
end: legend
-->

<!---
end: affixing
-->
